---
title: "Graphics with the mosaic package"
author: "R Pruim"
date: ""
output: 
  html_document:
    fig_height: 3
    fig_width: 5
  pdf_document:
    fig_height: 3
    fig_width: 5
  word_document:
    fig_height: 3
    fig_width: 5
---

<!--
%\VignetteEngine{knitr::knitr}
%\VignetteIndexEntry{Graphics with the mosaic package}
-->

```{r include=FALSE}
# Don't delete this chunk if you are using the mosaic package
# This loads the mosaic and dplyr packages
require(mosaic)
```

```{r include=FALSE}
# Some customization.  You can alter or delete as desired (if you know what you are doing).

# This changes the default colors in lattice plots.
trellis.par.set(theme=theme.mosaic())  

# knitr settings to control how R chunks work.
require(knitr)
set.seed(1)
opts_chunk$set(
  tidy=FALSE,     # display code as typed
  size="small"    # slightly smaller font for code
)
```


This vignette is simply a suite of plots that exist primarily as part of our quality
control for the package.  But since the example might be useful to others as well, we've added this as a vignette in the package.

### lattice extras

The `mosaic` package resets the default panel function for histograms.  This changes
the default for bin selection and provides some additional arguments to histogram.
```{r}
histogram(~ rbinom( 500, 20, .3), width=1, fit="normal", v=c(6,10), h=0.1 )
```

### ladd()

`ladd()` provides a relatively easy way to add additional things to a lattice graphic.

```{r, fig.keep="last"}
xyplot( rnorm(100) ~ rnorm(100) )
ladd( grid.text("Here is some text", x=0, y=0, default.units="native") )
ladd( panel.abline( a=0, b=1, col="red", lwd=3, alpha=.4 ) )
ladd( panel.rect(x=-1, y=-1, width=1, height=1, col="gray80", fill="lightsalmon"))
ladd( panel.rect(x=0, y=0, width=2, height=2, col="gray80", fill="lightskyblue"), 
      under=TRUE)
```

### mplot()

In addition to the interactive uses of `mplot()`, it can be used in place of `plot()` in
several settings.

```{r, fig.height=8}
require(gridExtra)
mod <- lm( width ~ length * sex, data=KidsFeet )
mplot(mod, w=1:7, multiplot = TRUE, ncol=2)
```

```{r, fig.height=8}
mplot(mod, w=1:7, system="ggplot", ncol=2)
```

```{r}
mplot(mod, w=7)
mplot(mod, w=7, rows=-1)
mplot(mod, w=7, rows=c("sexG", "width", "width:sexG"), 
      title="Custom titles are supported")
```
```{r}
mod <- lm(age ~ substance, data=HELPrct)
mplot(TukeyHSD(mod))
mplot(TukeyHSD(mod), system="ggplot")
```

### plotFun() and makeFun()


```{r, fig.keep="last"}
mod <- lm(length ~ width * sex, data = KidsFeet)
L <- makeFun(mod)
L( width=9, sex="B")
L( width=9, sex="G")
xyplot(length ~ width, groups = sex, data = KidsFeet, auto.key=TRUE)
plotFun( L(width, sex="B") ~ width, add=TRUE, col=1 )
plotFun( L(width, sex="G") ~ width, add=TRUE, col=2 )
```

```{r}
f <- makeFun(sin(x) ~ x)
plotFun( f(x) ~ x, xlim = c( -2 * pi, 2 * pi) )
```

```{r}
plotFun( x * sin(1/x) ~ x, xlim=c(-1,1) )
plotFun( x * sin(1/x) ~ x, xlim=c(-1,1), npts=10000 )
```

